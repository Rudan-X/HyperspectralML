layoutcoor=read.csv("MATLAB/barley_model/PSPR_coor.csv")
layoutcoor=as.matrix(layoutcoor)
newcoor=-layoutcoor+1000
newcoor[,2]=newcoor[,2]-250
newcoor[,1]=-newcoor[,1]
newcoor[,1]=newcoor[,1]+1000
tk_set_coords(6,newcoor)
edgeslist=c('RuBP[h]', 'RUBISCO','CO2[h]', 'RUBISCO','RUBISCO','PGA[h]','RUBISCO','PGA[h]', # v1
'PGA[h]','PGAK','ATP[h]1','PGAK','PGAK','DPGA[h]','PGAK','ADP[h]1', # v2
'DPGA[h]','GAPDH1','NADPH[h]','GAPDH1','GAPDH1','GAP[h]','GAPDH1','NADP[h]', # v3
'GAP[h]','TPI','TPI','DHAP[h]','GAP[h]','FBPA','DHAP[h]','FBPA','FBPA','FBP[h]', # v4, v5,
'FBP[h]','FBPase','FBPase','F6P[h]', # v6
'F6P[h]','FTK','GAP[h]','FTK','FTK','Xu5P[h]','FTK','E4P[h]', # v7
'E4P[h]','SBPA','DHAP[h]','SBPA','SBPA','SBP[h]', # v8
'SBP[h]','SBPase','SBPase','S7P[h]', # v9
'S7P[h]','STK','GAP[h]','STK','STK','Xu5P[h]','STK','RiBP[h]', # v10
'RiBP[h]','R5PI','R5PI','Ru5P[h]', 'Xu5P[h]','Ru5PE','Ru5PE','Ru5P[h]',# v11, v12
'Ru5P[h]','Ru5PK','ATP[h]2','Ru5PK','Ru5PK','ADP[h]2','Ru5PK','RuBP[h]',  # v13
'F6P[h]','PGI','PGI','G6P[h]','G6P[h]','PGM','PGM','G1P[h]', # v21, v22
'G1P[h]','AGPase','ATP[h]3','AGPase','AGPase','ADP[h]3','AGPase','ADPG[h]', #v23
'ADPG[h]','SS','SS','Gn[h]', #v24
# photorespiration
'RuBP[h]', 'RUBISCO','O2[h]','RUBISCO','RUBISCO','PGA[h]','RUBISCO','PGCA[h]', #v111
'PGCA[h]','v112','v112','GCA[h]','GCA[h]','v2out','v2out','GCA[c]',
'PGCA[h]','v113','v113','GCEA[h]','GCEA[h]','v1in','v1in','GCEA[c]',
'GCA[c]','v121','O2[c]','v121','v121','GOA[c]','v121','H2O2[h]',
'GOA[c]','v122','SER[c]','v122','v122','GLY[c]','v122','HPR[c]',
'HPR[c]','v123','NADH[c]','v123','v123','GCEA[c]','v123','NAD[c]',
'GOA[c]','v124','GLU[c]','v124','v124','KG[c]','v124','GLY[c]',
'GLY[c]','v131','NAD[c]2','v131','v131','SER[c]','v131','NADH[c]2','v131','CO2[c]',
'CO2[h]','A','CO2[c]','A','A','photosynthesis')
metlist=c('RuBP[h]','PGA[h]','DPDGA[h]','T3P', 'FBP[h]','E4P[h]','S7P[h]',
'SBP[h]','ATP[h]','NADPH[h]','CO2[h]','O2[h]','HexP', 'PenP','GCEA[h]',
'GCA[h]','PGCA[h]','GCA[c]','GOA[c]','SER[c]','GLY[c]','HPR[c]','GCEA[c]',
'ADPG[h]','GAP[h]','DHAP[h]','NADP[h]','F6P[h]','Xu5P[h]','RiBP[h]','Ru5P[h]',
'G6P[h]','G1P[h]')
enzlist=c('RUBISCO','PGAK','GAPDH1','TPI','FBPA','FBPase','FTK','SBPA','SBPase','STK','R5PI','Ru5PE','Ru5PK','PGI','PGM','AGPase','SS',
'v112','v113','v2out','v1in','v121','v122','v123','v124','v131','A','photosynthesis')
g1 <- graph(edges=edgeslist, directed=T)
V(g1)$color=rep("blue",vcount(g1))
V(g1)$color[V(g1)$name%in%enzlist]="purple"
V(g1)$cex=rep(0.7,vcount(g1))
V(g1)$cex[V(g1)$name%in%enzlist]=0.6
plot(g1,edge.arrow.size=.2,vertex.label.cex=V(g1)$cex,vertex.label.color=V(g1)$color,vertex.size=0,)
layoutcoor=read.csv("MATLAB/barley_model/PSPR_coor.csv")
layoutcoor=as.matrix(layoutcoor)
newcoor=-layoutcoor+1000
newcoor[,2]=newcoor[,2]-250
newcoor[,1]=-newcoor[,1]
newcoor[,1]=newcoor[,1]+1000
plot(g1,vertex.shape=g1$shapes,edge.arrow.size=.2,vertex.label.cex=V(g1)$cex,
vertex.label.color=V(g1)$color,vertex.size=0,layout=newcoor)
layoutcoor=read.csv("MATLAB/barley_model/PSPR_coor.csv")
layoutcoor=as.matrix(layoutcoor)
plot(g1,vertex.shape=g1$shapes,edge.arrow.size=.2,vertex.label.cex=V(g1)$cex,
vertex.label.color=V(g1)$color,vertex.size=0,layout=newcoor)
layoutcoor=read.csv("MATLAB/barley_model/PSPR_coor.csv")
plot(g1,vertex.shape=g1$shapes,edge.arrow.size=.2,vertex.label.cex=V(g1)$cex,
vertex.label.color=V(g1)$color,vertex.size=0,layout=layoutcoor)
layoutcoor=read.csv("MATLAB/barley_model/PSPR_coor.csv")
layoutcoor=as.matrix(layoutcoor)
plot(g1,vertex.shape=g1$shapes,edge.arrow.size=.2,vertex.label.cex=V(g1)$cex,
vertex.label.color=V(g1)$color,vertex.size=0,layout=layoutcoor)
plot(g1,vertex.shape=g1$shapes,edge.arrow.size=.1.5,vertex.label.cex=V(g1)$cex,
plot(g1,vertex.shape=g1$shapes,edge.arrow.size=.15,vertex.label.cex=V(g1)$cex,
vertex.label.color=V(g1)$color,vertex.size=0,layout=layoutcoor)
plot(g1,vertex.shape=g1$shapes,edge.arrow.size=.1,vertex.label.cex=V(g1)$cex,
vertex.label.color=V(g1)$color,vertex.size=0,layout=layoutcoor)
# for tkplot
id <- tkplot(g1)
newcoor=-layoutcoor+1000
newcoor[,2]=newcoor[,2]-250
newcoor[,1]=-newcoor[,1]
newcoor[,1]=newcoor[,1]+1000
tk_set_coords(id,newcoor)
View(layoutcoor)
lay=read.csv("MATLAB/barley_model/adjusted_coor2.csv")
lay=as.matrix(lay)
layoutcoor[44:73,]=lay[44:73,]
layoutcoor=read.csv("MATLAB/barley_model/PSPR_coor.csv")
layoutcoor=as.matrix(layoutcoor)
lay=read.csv("MATLAB/barley_model/adjusted_coor2.csv")
lay=as.matrix(lay)
layoutcoor[1:43,]=lay[1:43,]
plot(g1,vertex.shape=g1$shapes,edge.arrow.size=.1,vertex.label.cex=V(g1)$cex,
vertex.label.color=V(g1)$color,vertex.size=0,layout=layoutcoora)
plot(g1,vertex.shape=g1$shapes,edge.arrow.size=.1,vertex.label.cex=V(g1)$cex,
vertex.label.color=V(g1)$color,vertex.size=0,layout=layoutcoor)
layoutcoor=read.csv("MATLAB/barley_model/PSPR_coor.csv")
layoutcoor=as.matrix(layoutcoor)
lay=read.csv("MATLAB/barley_model/adjusted_coor2.csv")
lay=as.matrix(lay)
lay[,2]=lay[,2]+100
layoutcoor[1:43,]=lay[1:43,]
plot(g1,vertex.shape=g1$shapes,edge.arrow.size=.1,vertex.label.cex=V(g1)$cex,
vertex.label.color=V(g1)$color,vertex.size=0,layout=layoutcoor)
lay=read.csv("MATLAB/barley_model/adjusted_coor2.csv")
lay=as.matrix(lay)
lay[,1]=lay[,1]-100
layoutcoor[1:43,]=lay[1:43,]
plot(g1,vertex.shape=g1$shapes,edge.arrow.size=.1,vertex.label.cex=V(g1)$cex,
vertex.label.color=V(g1)$color,vertex.size=0,layout=layoutcoor)
lay=read.csv("MATLAB/barley_model/adjusted_coor2.csv")
lay=as.matrix(lay)
lay[,1]=lay[,1]-500
layoutcoor[1:43,]=lay[1:43,]
plot(g1,vertex.shape=g1$shapes,edge.arrow.size=.1,vertex.label.cex=V(g1)$cex,
vertex.label.color=V(g1)$color,vertex.size=0,layout=layoutcoor)
ecount(g1)
############## FLUX ANALYSIS ###################
E(g1)$reactions=rep('',ecount(g1))
E(g1)$reactions[c(4,8,12,14,17,19,23,26,28,32,34,36,40,42,44,48,50,54,56,58,60,62,66,70,74,78,83,86)]=
c('v1','v2','v3','v4','v5','v6','v7','v8','v9','v10','v11','v12','v13','v21','v22','v23','v24',
'v111','v112','v113','v121','v122','v123','v124','v131','A','photosynthesis')
length(c(4,8,12,14,17,19,23,26,28,32,34,36,40,42,44,48,50,54,56,58,60,62,66,70,74,78,83,86))
length(c('v1','v2','v3','v4','v5','v6','v7','v8','v9','v10','v11','v12','v13','v21','v22','v23','v24',
'v111','v112','v113','v121','v122','v123','v124','v131','A','photosynthesis'))
############## FLUX ANALYSIS ###################
E(g1)$reactions=rep('',ecount(g1))
E(g1)$reactions[c(4,8,12,14,17,19,23,26,28,32,34,36,40,42,44,48,50,54,56,58,60,62,66,70,74,78,83,86)]=
c('v1','v2','v3','v4','v5','v6','v7','v8','v9','v10','v11','v12','v13','v21','v22','v23','v24',
'v111','v112','v2out','v113','v1in','v121','v122','v123','v124','v131','photosynthesis')
PSrate=read.csv("MATLAB/barley_model/PSrate.csv")
PRrate=read.csv("MATLAB/barley_model/PRrate.csv")
PSrate=read.csv("MATLAB/barley_model/PSrate.csv")
PRrate=t(read.csv("MATLAB/barley_model/PRrate.csv"))
PSrate=read.csv("MATLAB/barley_model/PSrate.csv")
PRrate=read.csv("MATLAB/barley_model/PRrate.csv")
PSrate=read.csv("MATLAB/barley_model/PSrate.csv")
PRrate=t(read.csv("MATLAB/barley_model/PRrate.csv"))
View(PRrate)
PSrate=read.csv("MATLAB/barley_model/PSrate.csv",row.names = F)
PSrate=read.csv("MATLAB/barley_model/PSrate.csv")
PRrate=t(read.csv("MATLAB/barley_model/PRrate.csv"))
E(g1)$reactions=rep('',ecount(g1))
E(g1)$reactions[c(4,8,12,14,17,19,23,26,28,32,34,36,40,42,44,48,50,54,56,58,60,62,66,70,74,78,83,86)]=
c('v1','v2','v3','v4','v5','v6','v7','v8','v9','v10','v11','v12','v13','v21','v22','v23','v24',
'v111','v112','v2out','v113','v1in','v121','v122','v123','v124','v131','photosynthesis')
PSrate=read.csv("MATLAB/barley_model/PSrate.csv")
PRrate=t(read.csv("MATLAB/barley_model/PRrate.csv"))
reactions=c('v1','v2','v3','null','v5','v6','v7','v8','v9','v10','v13','v16','v23','v32','v33','Pi','v24',
'v111','v112','v113','v121','v122','v123','v124','v131','v1in','v2out')
PSrate=read.csv("MATLAB/barley_model/PSrate.csv")
PRrate=read.csv("MATLAB/barley_model/PRrate.csv")
rates=cbind(PSrate,PRrate)
rates=rbind(PSrate,PRrate)
flux=rates[,ncol(rates)]
ind1=match(E(g1)$reactions,reactions)
ind1=match(E(g1)$reactions,reactions)
E(g1)$flux=round(flux[ind1],2)
plot(g1,vertex.shape=g1$shapes,edge.arrow.size=.2,vertex.label.cex=V(g1)$cex,
vertex.label.color=V(g1)$color,vertex.size=0,layout=as.matrix(layoutcoor),
edge.label=E(g1)$flux,edge.label.cex=0.8)
plot(g1,vertex.shape=g1$shapes,edge.arrow.size=.2,vertex.label.cex=V(g1)$cex,
vertex.label.color=V(g1)$color,vertex.size=0,layout=as.matrix(layoutcoor),
edge.label=E(g1)$flux,edge.label.cex=0.8,edge.label.color="black")
PSrateEPS=read.csv("MATLAB/barley_model/PSrate_EPS.csv")
PRrateEPS=read.csv("MATLAB/barley_model/PRrate_EPS.csv")
rates=rbind(PSrateEPS,PRrateEPS)
flux=rates[,ncol(rates)]
E(g1)$flux=round(flux[ind1],2)
plot(g1,vertex.shape=g1$shapes,edge.arrow.size=.2,vertex.label.cex=V(g1)$cex,
vertex.label.color=V(g1)$color,vertex.size=0,layout=as.matrix(layoutcoor),
edge.label=E(g1)$flux,edge.label.cex=0.8,edge.label.color="black")
flux=c(flux,(flux[1]-flux[9])*30)
############## FLUX ANALYSIS ###################
E(g1)$reactions=rep('',ecount(g1))
E(g1)$reactions[c(4,8,12,14,17,19,23,26,28,32,34,36,40,42,44,48,50,54,56,58,60,62,66,70,74,78,83,86)]=
c('v1','v2','v3','v4','v5','v6','v7','v8','v9','v10','v11','v12','v13','v21','v22','v23','v24',
'v111','v112','v2out','v113','v1in','v121','v122','v123','v124','v131','photosynthesis')
PSrate=read.csv("MATLAB/barley_model/PSrate.csv")
PRrate=read.csv("MATLAB/barley_model/PRrate.csv")
rates=rbind(PSrate,PRrate)
reactions=c('v1','v2','v3','null','v5','v6','v7','v8','v9','v10','v13','v16','v23','v32','v33','Pi','v24',
'v111','v112','v113','v121','v122','v123','v124','v131','v1in','v2out','photosynthesis')
flux=rates[,ncol(rates)]
flux=c(flux,(flux[1]-flux[9])*30)
ind1=match(E(g1)$reactions,reactions)
E(g1)$flux=round(flux[ind1],2)
plot(g1,vertex.shape=g1$shapes,edge.arrow.size=.2,vertex.label.cex=V(g1)$cex,
vertex.label.color=V(g1)$color,vertex.size=0,layout=as.matrix(layoutcoor),
edge.label=E(g1)$flux,edge.label.cex=0.8,edge.label.color="black")
flux[9]
flux
17+9
flux[26]
flux=rates[,ncol(rates)]
flux=c(flux,(flux[1]-flux[26])*30)
ind1=match(E(g1)$reactions,reactions)
E(g1)$flux=round(flux[ind1],2)
plot(g1,vertex.shape=g1$shapes,edge.arrow.size=.2,vertex.label.cex=V(g1)$cex,
vertex.label.color=V(g1)$color,vertex.size=0,layout=as.matrix(layoutcoor),
edge.label=E(g1)$flux,edge.label.cex=0.8,edge.label.color="black")
(flux[1]-flux[26])*30
flux=rates[,ncol(rates)]
flux=c(flux,(flux[1]-flux[26])*30)
ind1=match(E(g1)$reactions,reactions)
E(g1)$flux=round(flux[ind1],2)
plot(g1,vertex.shape=g1$shapes,edge.arrow.size=.2,vertex.label.cex=V(g1)$cex,
vertex.label.color=V(g1)$color,vertex.size=0,layout=as.matrix(layoutcoor),
edge.label=E(g1)$flux,edge.label.cex=0.8,edge.label.color="black")
ind1=match(E(g1)$reactions,reactions)
ind1
rates[28]
E(g1)$flux[28]
flux
E(g1)$flux
ind1=match(reactions,E(g1)$reactions)
E(g1)$flux=round(flux[ind1],2)
flux[28]
flux=rates[,ncol(rates)]
flux=c(flux,(flux[1]-flux[26])*30)
length(flux)
reactions=c('v1','v2','v3','null','v5','v6','v7','v8','v9','v10','v13','v16','v23','v32','v33','Pi','v24',
'v111','v112','v113','v121','v122','v123','v124','v131','v1in','v2out','photosynthesis')
length(reactions)
flux=rates[,ncol(rates)]
length(reactions)
c('v1','v2','v3','v4','v5','v6','v7','v8','v9','v10','v11','v12','v13','v21','v22','v23','v24')
length(c('v1','v2','v3','v4','v5','v6','v7','v8','v9','v10','v11','v12','v13','v21','v22','v23','v24'))
rates=rates[-17,]
PSrate=read.csv("MATLAB/barley_model/PSrate.csv")
PRrate=read.csv("MATLAB/barley_model/PRrate.csv")
rates=rbind(PSrate,PRrate)
reactions=c('v1','v2','v3','null','v5','v6','v7','v8','v9','v10','v13','v16','v23','v32','v33','v24',
'v111','v112','v113','v121','v122','v123','v124','v131','v1in','v2out','photosynthesis')
rates=rates[-17,]
flux=rates[,ncol(rates)]
flux=c(flux,(flux[1]-flux[26])*30)
ind1=match(reactions,E(g1)$reactions)
E(g1)$flux=round(flux[ind1],2)
ind1=match(E(g1)$reactions,reactions)
E(g1)$flux=round(flux[ind1],2)
plot(g1,vertex.shape=g1$shapes,edge.arrow.size=.2,vertex.label.cex=V(g1)$cex,
vertex.label.color=V(g1)$color,vertex.size=0,layout=as.matrix(layoutcoor),
edge.label=E(g1)$flux,edge.label.cex=0.8,edge.label.color="black")
flux
ind1
PSrate=read.csv("MATLAB/barley_model/PSrate.csv")
PRrate=read.csv("MATLAB/barley_model/PRrate.csv")
rates=rbind(PSrate,PRrate)
reactions=c('v1','v2','v3','null','v5','v6','v7','v8','v9','v10','v13','v16','v23','v32','v33','v24',
'v111','v112','v113','v121','v122','v123','v124','v131','v1in','v2out','photosynthesis')
rates=rates[-17,]
flux=rates[,ncol(rates)]
flux=c(flux,(flux[1]-flux[26])*30)
ind1=match(E(g1)$reactions,reactions)
ind1
length(reactions)
E(g1)$reactions=rep('',ecount(g1))
E(g1)$reactions[c(4,8,12,14,17,19,23,26,28,32,34,36,40,42,44,48,50,54,56,58,60,62,66,70,74,78,83,86)]=
c('v1','v2','v3','v4','v5','v6','v7','v8','v9','v10','v11','v12','v13','v21','v22','v23','v24',
'v111','v112','v2out','v113','v1in','v121','v122','v123','v124','v131','photosynthesis')
PSrate=read.csv("MATLAB/barley_model/PSrate.csv")
PRrate=read.csv("MATLAB/barley_model/PRrate.csv")
rates=rbind(PSrate,PRrate)
reactions=c('v1','v2','v3','null','v5','v6','v7','v8','v9','v10','v13','v16','v23','v31','v32','v33','v24',
'v111','v112','v113','v121','v122','v123','v124','v131','v1in','v2out','photosynthesis')
rates=rates[-17,]
flux=rates[,ncol(rates)]
flux=c(flux,(flux[1]-flux[26])*30)
ind1=match(E(g1)$reactions,reactions)
E(g1)$flux=round(flux[ind1],2)
E(g1)$flux
plot(g1,vertex.shape=g1$shapes,edge.arrow.size=.2,vertex.label.cex=V(g1)$cex,
vertex.label.color=V(g1)$color,vertex.size=0,layout=as.matrix(layoutcoor),
edge.label=E(g1)$flux,edge.label.cex=0.8,edge.label.color="black")
PSrateEPS=read.csv("MATLAB/barley_model/PSrate_EPS.csv")
PRrateEPS=read.csv("MATLAB/barley_model/PRrate_EPS.csv")
rates=rbind(PSrateEPS,PRrateEPS)
flux=rates[,ncol(rates)]
flux=c(flux,(flux[1]-flux[9])*30)
E(g1)$flux=round(flux[ind1],2)
plot(g1,vertex.shape=g1$shapes,edge.arrow.size=.2,vertex.label.cex=V(g1)$cex,
vertex.label.color=V(g1)$color,vertex.size=0,layout=as.matrix(layoutcoor),
edge.label=E(g1)$flux,edge.label.cex=0.8,edge.label.color="black")
flux=c(flux,(flux[1]-flux[26])*30)
E(g1)$flux=round(flux[ind1],2)
plot(g1,vertex.shape=g1$shapes,edge.arrow.size=.2,vertex.label.cex=V(g1)$cex,
vertex.label.color=V(g1)$color,vertex.size=0,layout=as.matrix(layoutcoor),
edge.label=E(g1)$flux,edge.label.cex=0.8,edge.label.color="black")
(flux[1]-flux[26])*30
E(g1)$flux
ind1
flux
PSrate=read.csv("MATLAB/barley_model/PSrate.csv")
PRrate=read.csv("MATLAB/barley_model/PRrate.csv")
rates=rbind(PSrate,PRrate)
reactions=c('v1','v2','v3','null','v5','v6','v7','v8','v9','v10','v13','v16','v23','v31','v32','v33','v24',
'v111','v112','v113','v121','v122','v123','v124','v131','v1in','v2out','photosynthesis')
rates=rates[-17,]
flux=rates[,ncol(rates)]
flux=c(flux,(flux[1]-flux[26])*30)
ind1=match(E(g1)$reactions,reactions)
E(g1)$flux=round(flux[ind1],2)
PSrateEPS=read.csv("MATLAB/barley_model/PSrate_EPS.csv")
PRrateEPS=read.csv("MATLAB/barley_model/PRrate_EPS.csv")
rates=rbind(PSrateEPS,PRrateEPS)
rates=rates[-17,]
flux=rates[,ncol(rates)]
flux=c(flux,(flux[1]-flux[26])*30)
E(g1)$flux=round(flux[ind1],2)
plot(g1,vertex.shape=g1$shapes,edge.arrow.size=.2,vertex.label.cex=V(g1)$cex,
vertex.label.color=V(g1)$color,vertex.size=0,layout=as.matrix(layoutcoor),
edge.label=E(g1)$flux,edge.label.cex=0.8,edge.label.color="black")
flux
ind1
E(g1)$flux
plot(g1,vertex.shape=g1$shapes,edge.arrow.size=.2,vertex.label.cex=V(g1)$cex,
vertex.label.color=V(g1)$color,vertex.size=0,layout=as.matrix(layoutcoor),
edge.label=E(g1)$flux,edge.label.cex=0.8,edge.label.color="black")
E(g1)$reactions=rep('',ecount(g1))
E(g1)$reactions[c(4,8,12,14,17,19,23,26,28,32,34,36,40,42,44,48,50,54,56,58,60,62,66,70,74,78,83,86)]=
c('v1','v2','v3','v4','v5','v6','v7','v8','v9','v10','v11','v12','v13','v21','v22','v23','v24',
'v111','v112','v2out','v113','v1in','v121','v122','v123','v124','v131','photosynthesis')
PSrate=read.csv("MATLAB/barley_model/PSrate.csv")
PRrate=read.csv("MATLAB/barley_model/PRrate.csv")
rates=rbind(PSrate,PRrate)
reactions=c('v1','v2','v3','null','v5','v6','v7','v8','v9','v10','v13','v16','v23','v31','v32','v33','v24',
'v111','v112','v113','v121','v122','v123','v124','v131','v1in','v2out','photosynthesis')
rates=rates[-17,]
rates=rates*30;
flux=rates[,ncol(rates)]
flux=c(flux,flux[1]-flux[26])
ind1=match(E(g1)$reactions,reactions)
E(g1)$flux=round(flux[ind1],2)
plot(g1,vertex.shape=g1$shapes,edge.arrow.size=.2,vertex.label.cex=V(g1)$cex,
vertex.label.color=V(g1)$color,vertex.size=0,layout=as.matrix(layoutcoor),
edge.label=E(g1)$flux,edge.label.cex=0.8,edge.label.color="black")
PSrateEPS=read.csv("MATLAB/barley_model/PSrate_EPS.csv")
PRrateEPS=read.csv("MATLAB/barley_model/PRrate_EPS.csv")
rates=rbind(PSrateEPS,PRrateEPS)
rates=rates*30;
rates=rates[-17,]
flux=rates[,ncol(rates)]
flux=c(flux,flux[1]-flux[26])
E(g1)$flux=round(flux[ind1],2)
plot(g1,vertex.shape=g1$shapes,edge.arrow.size=.2,vertex.label.cex=V(g1)$cex,
vertex.label.color=V(g1)$color,vertex.size=0,layout=as.matrix(layoutcoor),
edge.label=E(g1)$flux,edge.label.cex=0.8,edge.label.color="black")
source("~/CAPITALIZE_ML/script/Rfunctions.R")
check=read.delim("C:/Users/Rudan/Documents/orphan.txt")
View(check)
check=read.delim("C:/Users/Rudan/Documents/orphan.txt",header = F)
View(check)
colnames(check)='Orphan genes'
View(check)
write.csv(check,file="C:/Users/Rudan/Desktop/orphan genes/all_orphan_genes.csv")
write.csv(check,file="C:/Users/Rudan/Desktop/orphan genes/all_orphan_genes.csv",row.names = F)
segments=3
list.of.packages <- c("pls","dplyr","plotrix","ggplot2","gridExtra","chemometrics","reshape2","ggpubr","ggh4x")
invisible(lapply(list.of.packages, library, character.only = TRUE))
setwd("C:/Users/Rudan/Documents/GitHub/HyperspectralML/")
for (file in c("R_Burnett/","myR/")){
filen<-paste0("C:/Users/Rudan/Documents/GitHub/HyperspectralML/R/",file)
myls <- list.files(path=filen,pattern="*.R")
myls<-paste0(filen,myls)
invisible(sapply(myls,FUN=source))
}
get_R2 <- function(meas,pred){
R2=1-sum((meas-pred)^2)/sum((meas-mean(meas))^2)
return(R2)
}
vars<-c( "SLA","N","Vmax","a400","phiPSII_ind_res","maxNPQ") #
# "SLA","N","CN","Vpmax","Vmax","gsw","a400","phiPSII_ind_res","maxNPQ","endFvFm","initialFvFm"
year <- 2021
segments0 <- 5
nrep <- 20
segment <- 3
repl <- 10
agg <- "sampledHSR" #
dataset<-c("Calibration","Validation")
datatypes <- c("raw_data","plot_averaged","genotype_averaged")
datalabel <- c("Raw data","Averaged by replicate","Averaged by genotype") #
ini<-TRUE
ini2<-TRUE
for (d in 1:3){#
datatype <- datatypes[d]
for (inVar in vars){
traitHSR <- read.csv(paste0("data/combined_data/traits_and_HSR",year,"_",datatype,".csv"))
if (inVar=="N" | inVar=="CN"){
Start.wave <- 1500
End.wave <- 2400
}else{
Start.wave <- 400
End.wave <- 2400
}
if (agg=="fullHSR"){
wv <- seq(Start.wave,End.wave,1)
}else{
wv <- seq(Start.wave,End.wave,by=5)
}
spec <- as.matrix(traitHSR[, which(names(traitHSR) %in%  paste0("mean_",wv))])
traitHSR <- cbind(data.frame(y=traitHSR[,inVar]),spec)
colnames(traitHSR)[1] <- "y"
traitHSR <- traitHSR[!is.na(traitHSR$y),]
load(paste0("results/comparePLSR_SVR/PLSR_repeatedCV_model_",datatype,"_",agg,year,"_o", segments0*nrep,"i",segment*repl,"_",inVar,".RData"))
folds <- res.rcv.mse$folds
for (r in 1:20){
pred <- matrix(NA,nrow(res.rcv.mse$pred),1)
for (f in 1:length(folds[[r]])){
val.ind <- folds[[r]][[f]]
cal.ind <- setdiff(seq(1,nrow(res.rcv.mse$pred)),val.ind)
pred[val.ind] <- res.rcv.mse$pred[val.ind,(r-1)*segments0+f]
}
if (ini){
df_recR2<-data.frame(score=get_R2(traitHSR$y,pred),trait=inVar,Model="PLSR",datatype=datalabel[d],metric="Coefficient of determination")
df_recRMSEP<-data.frame(score=round(sqrt(mean((traitHSR$y-pred)^2)),2),trait=inVar,Model="PLSR",datatype=datalabel[d],metric="RMSE%")
ini <- FALSE
}else{
df_recR2<- rbind(df_recR2,data.frame(score=get_R2(traitHSR$y,pred),trait=inVar,Model="PLSR",datatype=datalabel[d],metric="Coefficient of determination"))
df_recRMSEP<- rbind(df_recRMSEP,data.frame(score=round(sqrt(mean((traitHSR$y-pred)^2)),2),trait=inVar,Model="PLSR",datatype=datalabel[d],metric="RMSE%"))
}
}
t <- 2
if (ini2){
df_origR2<-data.frame(score=apply(res.rcv.mse$R2[[t]], 2, mean),trait=inVar,Model="PLSR",datatype=datalabel[d],metric="Coefficient of determination")
df_origRMSEP<-data.frame(score=apply(res.rcv.mse$RMSEP[[t]], 2, mean),trait=inVar,Model="PLSR",datatype=datalabel[d],metric="RMSE%")
ini2<-FALSE
}else{
df_origR2<-rbind(df_origR2,data.frame(score=apply(res.rcv.mse$R2[[t]], 2, mean),trait=inVar,Model="PLSR",datatype=datalabel[d],metric="Coefficient of determination"))
df_origRMSEP<-rbind(df_origRMSEP,data.frame(score=apply(res.rcv.mse$RMSEP[[t]], 2, mean),trait=inVar,Model="PLSR",datatype=datalabel[d],metric="RMSE%"))
}
}
}
df_recR2$Gathering <- "Reconstruction"
df_recRMSEP$Gathering <- "Reconstruction"
df_origR2$Gathering <- "Individual folds"
df_origRMSEP$Gathering <- "Individual folds"
df <- rbind(df_origR2,df_origRMSEP,df_recR2,df_recRMSEP)
df$Trait_type <- varclass[match(df$trait,var1)]
df$Trait_type <- factor(df$Trait_type,levels=c("Structural & biochemical","Gas exchange","Chlorophyll fluorescence"))
df$trait <- var2[match(df$trait,var1)] # var1 and var2loaded by  myR/change_var_names.R
df$trait <- factor(df$trait, levels=var2[match(vars,var1)])
df$Model <- factor(df$Model,levels=unique(df$Model))
df$datatype <- factor(df$datatype,levels=datalabel)
stat_box_data <- function(y) {
return(
data.frame(
y = max(y),  #may need to modify this depending on your data
label = paste(round(median(y),2), '\n')
)
)
}
ggplot(df, aes(x=trait, y=score,fill=Gathering)) +
geom_boxplot()+
facet_grid(metric ~ datatype,scales="free")+ #, switch = "y"
labs(y="Evaluation performance",x="") +
stat_summary(fun.data = stat_box_data,geom = "text", aes(group=Gathering), size=4,position=position_dodge(0.9)) +
theme(legend.position = "bottom",legend.text = element_text(size=15,face="plain"),legend.title=element_text(size=16,face="bold"),
text = element_text(size = 14,face="bold"),axis.text =  element_text(size = 14,face="bold"),
axis.title=element_text(size=16,face="bold"), strip.text = element_text(size=15,face="bold"))+
stat_compare_means(label = "p.signif",label.y = -0.4) +
scale_fill_brewer(name = "Metric collection")
ggsave("Figures/SF_sec3.4b_PLSR_aggregation_metrics.png",width = 10, height = 8)
ggsave("Figures/SF_sec3.4b_PLSR_aggregation_metrics.png",width = 10, height = 6)
ggsave("Figures/SF_sec3.4b_PLSR_aggregation_metrics.png",width = 14, height = 8)
ggplot(df, aes(x=trait, y=score,fill=Gathering)) +
geom_boxplot()+
facet_grid(metric ~ datatype,scales="free")+ #, switch = "y"
labs(y="Evaluation performance",x="") +
stat_summary(fun.data = stat_box_data,geom = "text", aes(group=Gathering), size=4,position=position_dodge(0.9)) +
theme(legend.position = "bottom",legend.text = element_text(size=15,face="plain"),legend.title=element_text(size=16,face="bold"),
text = element_text(size = 14,face="bold"),axis.text =  element_text(size = 12,face="bold"),
axis.title=element_text(size=16,face="bold"), strip.text = element_text(size=15,face="bold"))+
stat_compare_means(label = "p.signif",label.y = -0.4) +
scale_fill_brewer(name = "Metric collection")
ggsave("Figures/SF_sec3.4b_PLSR_aggregation_metrics.png",width = 14, height = 8)
ggplot(df, aes(x=trait, y=score,fill=Gathering)) +
geom_boxplot()+
facet_grid(datatype ~ metric,scales="free")+ #, switch = "y"
labs(y="Evaluation performance",x="") +
stat_summary(fun.data = stat_box_data,geom = "text", aes(group=Gathering), size=4,position=position_dodge(0.9)) +
theme(legend.position = "bottom",legend.text = element_text(size=15,face="plain"),legend.title=element_text(size=16,face="bold"),
text = element_text(size = 14,face="bold"),axis.text =  element_text(size = 12,face="bold"),
axis.title=element_text(size=16,face="bold"), strip.text = element_text(size=15,face="bold"))+
stat_compare_means(label = "p.signif",label.y = -0.4) +
scale_fill_brewer(name = "Metric collection")
ggsave("Figures/SF_sec3.4b_PLSR_aggregation_metrics.png",width = 8, height = 12)
ggplot(df, aes(x=trait, y=score,fill=Gathering)) +
geom_boxplot()+
ggh4x::facet_grid2(datatype ~ metric, scales = "free", independent = "y")+
labs(y="Evaluation performance",x="") +
stat_summary(fun.data = stat_box_data,geom = "text", aes(group=Gathering), size=4,position=position_dodge(0.9)) +
theme(legend.position = "bottom",legend.text = element_text(size=15,face="plain"),legend.title=element_text(size=16,face="bold"),
text = element_text(size = 14,face="bold"),axis.text =  element_text(size = 12,face="bold"),
axis.title=element_text(size=16,face="bold"), strip.text = element_text(size=15,face="bold"))+
stat_compare_means(label = "p.signif",label.y = -0.4) +
scale_fill_brewer(name = "Metric collection")
ggplot(df, aes(x=trait, y=score,fill=Gathering)) +
geom_boxplot()+
ggh4x::facet_grid2(datatype ~ metric, scales = "free", independent = "y")+
labs(y="Evaluation performance",x="") +
stat_summary(fun.data = stat_box_data,geom = "text", aes(group=Gathering), size=4,position=position_dodge(0.9)) +
theme(legend.position = "bottom",legend.text = element_text(size=15,face="plain"),legend.title=element_text(size=16,face="bold"),
text = element_text(size = 14,face="bold"),axis.text =  element_text(size = 12,face="bold"),
axis.title=element_text(size=16,face="bold"), strip.text = element_text(size=15,face="bold"))+
stat_compare_means(label = "p.signif",label.y.npc = "bottom") +
scale_fill_brewer(name = "Metric collection")
ggsave("Figures/SF_sec3.4b_PLSR_aggregation_metrics.png",width = 8, height = 12)
ggsave("Figures/SF_sec3.4b_PLSR_aggregation_metrics.png",width = 8, height = 8)
ggplot(df, aes(x=trait, y=score,fill=Gathering)) +
geom_boxplot()+
ggh4x::facet_grid2(datatype ~ metric, scales = "free", independent = "y")+
labs(y="Evaluation performance",x="") +
stat_summary(fun.data = stat_box_data,geom = "text", aes(group=Gathering), size=4,position=position_dodge(0.9)) +
theme(legend.position = "bottom",legend.text = element_text(size=15,face="plain"),legend.title=element_text(size=16,face="bold"),
text = element_text(size = 14,face="bold"),axis.text =  element_text(size = 12,face="bold"),
axis.title=element_text(size=16,face="bold"), strip.text = element_text(size=15,face="bold"))+
stat_compare_means(label = "p.signif",label.y = -0.4) +
scale_fill_brewer(name = "Metric collection")
ggsave("Figures/SF_sec3.4b_PLSR_aggregation_metrics.png",width = 10, height = 12)
